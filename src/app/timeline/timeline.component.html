<div class="timeline-container" *ngIf="validTasks.length > 0">
  <div class="timeline-bar">
    <!-- Group markers by position to handle overlaps -->
    <div
      *ngFor="let group of getGroupedTasks()"
      [class]="'timeline-marker ' + getGroupMarkerClass(group)"
      [style.left]="getPosition(group[0].dueDate)"
    >
      <div class="timeline-tooltip">
        <div *ngFor="let task of group">
          <strong>{{ task.title }}</strong
          ><br />
        </div>
        {{ group[0].dueDate | date : "mediumDate" }}<br />
      </div>
      <!-- Show count badge if multiple tasks overlap -->
      <span class="overlap-badge" *ngIf="group.length > 1">{{
        group.length
      }}</span>
    </div>

    <div class="current-date-marker" [style.left]="getCurrentDatePosition()">
      <div class="current-date-line"></div>
      <div class="current-date-label">Today</div>
    </div>
  </div>

  <div class="timeline-labels">
    {{ startDate | date : "mediumDate" }}
    {{ endDate | date : "mediumDate" }}
  </div>
</div>
